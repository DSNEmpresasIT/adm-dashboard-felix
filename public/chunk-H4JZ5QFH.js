import{$a as l,J as d,ab as i,f as c}from"./chunk-XCIHP3OE.js";import{e as o}from"./chunk-VXZPRRN5.js";var w=(()=>{let a=class a{constructor(){this.supabaseUrl=i.SUPABASEURL,this.supabaseKey=i.SUPABASEKEY,this.productsSubject=new c([]),this.products=this.productsSubject.asObservable(),this.editProductSubject=new c(null),this.editProduct=this.editProductSubject.asObservable(),this.supabase=l(this.supabaseUrl,this.supabaseKey)}getProductById(e){return o(this,null,function*(){try{let{data:t,error:r}=yield this.supabase.from("products").select("*").eq("id",e);t&&t.length>0?this.editProductSubject.next(t[0]):r&&console.log("Error fetching product by ID:",r)}catch(t){console.log("Error:",t)}})}updateProduct(e){return o(this,null,function*(){try{let{data:t,error:r}=yield this.supabase.from("products").update(e).eq("id",e.id);r?console.error("Error al actualizar el producto:",r):console.log("Producto actualizado exitosamente:",t)}catch(t){console.error("Error al realizar la actualizaci\xF3n en Supabase:",t)}})}fetchAllCategories(){return o(this,null,function*(){try{return(yield this.supabase.from("categories").select("*")).data}catch(e){return console.log("Categor\xEDas no encontradas",e),null}})}fetchCategoryByName(e){return o(this,null,function*(){try{return(yield this.supabase.from("categories").select("*").ilike("category",`%${e}%`)).data}catch(t){return console.log("Categor\xEDas no encontradas",t),null}})}fetchAllProducts(){return o(this,null,function*(){try{let e=yield this.supabase.from("products").select("*");e.data&&this.productsSubject.next(e.data)}catch(e){console.log("error",e)}})}fetchProductsByName(e){return o(this,null,function*(){try{let t=yield this.supabase.from("products").select("*").ilike("name",`%${e}%`);t.data&&this.productsSubject.next(t.data)}catch(t){console.log("error",t)}})}fetchByCategory(e){return o(this,null,function*(){try{let t=yield this.supabase.from("categories").select("id").ilike("category",`%${e}%`);if(t.data){let r=t.data[0]?.id;if(r){let{data:n,error:f}=yield this.supabase.from("products_categories").select("product_id").eq("category_id",r);if(n){let p=n.map(h=>h.product_id),u=yield this.supabase.from("products").select("*").in("id",p);u.data&&this.productsSubject.next(u.data)}}}}catch(t){console.log("Error",t)}})}};a.\u0275fac=function(t){return new(t||a)},a.\u0275prov=d({token:a,factory:a.\u0275fac,providedIn:"root"});let s=a;return s})();export{w as a};
